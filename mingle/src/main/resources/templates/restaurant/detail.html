<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ì‹ë‹¹ ìƒì„¸ ì •ë³´</title>
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">

  <style>
    :root {
      --primary: #4285F4;
      --text-dark: #222222;
      --text-light: #717171;
      --bg-light: #F8F9FA;
      --border-color: #E8E9EC;
    }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      color: var(--text-dark);
      background-color: white;
    }

  /*  .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem;
    }*/

    .image-gallery {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      white-space: nowrap;
      padding-bottom: 8px;
    }

    .image-gallery img {
      width: 100%;
      max-height: 300px;
      object-fit: cover;
      border-radius: 10px;
    }

    .title {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .location {
      color: var(--text-light);
      font-size: 1rem;
      margin-bottom: 10px;
    }

    .features {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1rem;
    }

    .feature-badge {
      background-color: #F5F5F5;
      padding: 6px 12px;
      border-radius: 5px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .menu-section {
      margin-top: 20px;
    }

    .menu-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .menu-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .menu-card {
      display: flex;
      align-items: center;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .menu-image img {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      object-fit: cover;
      margin-right: 15px;
    }

    .menu-info {
      flex-grow: 1;
    }

    .menu-name {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .menu-price {
      font-size: 1rem;
      color: #555;
    }

    .reservation-info {
      margin-top: 30px;
    }

    .reserve-btn {
      display: block;
      width: 100%;
      padding: 12px;
      background-color: var(--primary);
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
      text-align: center;
      border-radius: 8px;
      margin-top: 1rem;
      cursor: pointer;
      text-decoration: none;
      border: none;
      outline: none;
    }

    .reserve-btn:hover {
      background-color: #3367d6;
    }
  </style>
</head>
<body>

<!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<div th:replace="~{fragments/navbar :: nav}"></div>
<br>
<br>
<br>
<br>
<!-- ìˆ™ì†Œ ìƒì„¸ ì»¨í…Œì´ë„ˆ -->
<div class="container">

  <!-- ìˆ™ì†Œ ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ -->
  <div class="image-gallery">
    <img th:each="photo : ${restaurant.outterPhotos}" th:src="${photo.image}" alt="ìˆ™ì†Œ ì´ë¯¸ì§€">
  </div>

  <!-- ìˆ™ì†Œ ê¸°ë³¸ ì •ë³´ -->
  <h1 class="title" th:text="${restaurant.restaurantName}"></h1>
  <p class="location">
    <i class="fas fa-map-marker-alt"></i> <span th:text="${restaurant.restaurantLocation}"></span>
  </p>

  <!-- í¸ì˜ì‹œì„¤ -->
  <div class="features">
    <span class="feature-badge" th:if="${restaurant.restaurantParking}">
      <i class="fas fa-parking"></i> ì£¼ì°¨ ê°€ëŠ¥
    </span>
    <span class="feature-badge">
      <i class="fas fa-wifi"></i> ì™€ì´íŒŒì´
    </span>
  </div>

  <!-- ì˜ì—… ì‹œê°„ -->
  <div class="accommodation-times">
    <p>ì˜ì—…ì‹œê°„ <span th:text="${restaurant.restaurantOpenTime}"></span> ~ <span th:text="${restaurant.restaurantEndTime}"></span></p>
  </div>

  <!-- ë©”ë‰´ ì •ë³´ ì„¹ì…˜ -->
  <div class="menu-section">
    <h2 class="menu-title">ë©”ë‰´ ì •ë³´</h2>
    <div class="menu-list">
      <div th:each="menu : ${menuList}" class="menu-item">
        <!-- ë©”ë‰´ ì¹´ë“œ -->
        <div class="menu-card">
          <div class="menu-image">
            <img th:src="@{${menuImageMap[menu.id]}}" alt="ë©”ë‰´ ì´ë¯¸ì§€">
          </div>
          <div class="menu-info">
            <h3 class="menu-name" th:text="${menu.menu}">ë©”ë‰´ ì´ë¦„</h3>
            <p class="menu-price">
              â‚©<span th:text="${#numbers.formatInteger(menu.cost, 3, 'COMMA')}"></span> ì›
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… ì˜ˆì•½ ì •ë³´ ì…ë ¥ í¼ -->
  <form action="/reservation/restaurant" method="post">
    <!-- restaurantId ê°’ ì¶”ê°€ -->
    <input type="hidden" name="restaurantId" th:value="${restaurant.id}">
    <input type="hidden" name="checkinTime" th:value="${restaurant.restaurantOpenTime}">

    <div class="reservation-info">
      <label for="reservation-date">ì˜ˆì•½ ë‚ ì§œ:</label>
      <input type="date" id="reservation-date" name="reservationDate" required>

      <label for="reservation-time">ì˜ˆì•½ ì‹œê°„:</label>
      <input type="time" id="reservation-time" name="reservationTime" required>
    </div>

    <!-- ì˜ˆì•½ ë²„íŠ¼ì„ submitìœ¼ë¡œ ë³€ê²½ -->
    <button type="submit" class="reserve-btn" id="reserve-btn">ì˜ˆì•½í•˜ê¸°</button>
  </form>

</div>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    var navigationEntries = performance.getEntriesByType("navigation");

    // ğŸ”¹ ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°(ë§ˆìš°ìŠ¤ ë²„íŠ¼ í¬í•¨) ê°ì§€
    window.addEventListener("popstate", function(event) {
      var prevPage = "[[${session.prevPage}]]"; // ğŸ”¹ Thymeleafì—ì„œ ì´ì „ í˜ì´ì§€ URL ê°€ì ¸ì˜¤ê¸°
      console.log("ë’¤ë¡œê°€ê¸° ê°ì§€ë¨, ì´ì „ í˜ì´ì§€:", prevPage); // âœ… ë””ë²„ê¹…ìš© ë¡œê·¸ ì¶”ê°€

      if (prevPage && prevPage !== "null") {
        window.location.href = prevPage;  // ğŸ”¹ ì´ì „ í˜ì´ì§€ë¡œ ì´ë™
      } else {
        window.location.href = "/restaurants/filterList";  // ğŸ”¹ ê¸°ë³¸ì ìœ¼ë¡œ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ì´ë™
      }
    });

    // âœ… í˜„ì¬ í˜ì´ì§€ë¥¼ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€ (ë§ˆìš°ìŠ¤ ë’¤ë¡œê°€ê¸° ì´ë²¤íŠ¸ ê°ì§€ë¥¼ ìœ„í•´ í•„ìš”)
    history.pushState(null, null, location.href);
  });
</script>






<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
